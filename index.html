  <!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Disaster Relief Helper</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-sA+e2b8G4rYpG1w5xUu3Wn3KQdJvQ3Kf2p3F3k2X0LE=" crossorigin=""/>

  <style>
    /* --- UI styles (inlined for single-file usage) --- */
    body { margin:0; font-family: Inter, Arial, sans-serif; background:#f6f8fb; color:#222; }
    .topbar { display:flex; justify-content:space-between; align-items:center; padding:12px 20px; background:#ffffff; box-shadow: 0 1px 6px rgba(0,0,0,0.06); position:sticky; top:0; z-index:1000; }
    .topbar h1 { margin:0; font-size:20px; }
    .role-select { display:flex; gap:8px; align-items:center; }
    .main { display:flex; gap:16px; padding:18px; max-width:1200px; margin:18px auto; }
    .left { width:420px; }
    .right { flex:1; min-height:640px; }
    #form-box { background:#fff; padding:14px; border-radius:8px; box-shadow:0 4px 18px rgba(20,30,40,0.05); margin-bottom:14px; }
    #form-box input, #form-box textarea { width:100%; padding:8px 10px; margin:6px 0; border-radius:6px; border:1px solid #e6e9ef; font-size:14px; }
    #form-box .row { display:flex; gap:8px; }
    #form-box button { padding:8px 12px; border-radius:8px; border:none; background:#2b7cff; color:#fff; cursor:pointer; }
    #requests-list { background:#fff; padding:12px; border-radius:8px; box-shadow:0 4px 18px rgba(20,30,40,0.05); }
    #list { list-style:none; padding:0; margin:0; max-height:420px; overflow:auto; }
    #list li { padding:10px; border-bottom:1px solid #f1f3f6; display:flex; justify-content:space-between; align-items:center; }
    .status-open { color:#2b7cff; font-weight:600; }
    .status-claimed { color:#ff9900; font-weight:600; }
    .status-fulfilled { color:#2db84c; font-weight:600; }
    .claim-btn { padding:6px 8px; border-radius:6px; border:none; cursor:pointer; background:#2b7cff; color:#fff; }
    #map { width:100%; height:640px; border-radius:8px; box-shadow:0 6px 18px rgba(20,30,40,0.06); overflow:hidden; }
    .small { font-size:12px; color:#58606a; }
    @media (max-width: 900px) {
      .main { flex-direction:column; padding:12px; }
      .left { width:100%; }
      #map { height:420px; }
    }
  </style>
</head>
<body>
  <div class="topbar">
    <h1>Disaster Relief Helper</h1>
    <div class="role-select">
      <label for="role">I'm a:</label>
      <select id="role">
        <option value="victim">Victim</option>
        <option value="donor" selected>Donor</option>
        <option value="ngo">NGO</option>
      </select>
    </div>
  </div>

  <div class="main">
    <div class="left">
      <div id="form-box">
        <h2 id="form-title">Post a Help Request</h2>

        <div id="victim-form">
          <input id="name" placeholder="Your name" />
          <input id="contact" placeholder="Contact (phone/email)" />
          <textarea id="description" placeholder="Briefly describe the help you need"></textarea>

          <div class="row">
            <input id="lat" placeholder="Latitude" />
            <input id="lng" placeholder="Longitude" />
            <button id="use-location">Use my location</button>
          </div>

          <div style="margin-top:8px;">
            <button id="post-request">Post Request</button>
          </div>
        </div>

        <div id="others-info" style="display:none;">
          <p>View requests on the map or claim one to help.</p>
          <p>When you claim a request, its status will change to <strong>claimed</strong>.</p>
        </div>
      </div>

      <div id="requests-list">
        <h3>Open Requests</h3>
        <ul id="list"></ul>
      </div>
    </div>

    <div class="right">
      <div id="map"></div>
    </div>
  </div>

  <!-- Socket.IO client -->
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"
    integrity="sha384-2mK1Q0pQkqJfP3v1Qq3Gq3E4Y7wY6mV7hJk6Y8k3pDq1s9w4H7Xj2u/3k0v7Zk8" crossorigin="anonymous"></script>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-oG2A6k3aYz6E9e7Q8kK2k5l7o4b6s7k3w2Q3s5x4fKs=" crossorigin=""></script>

  <script>
    /* --------- Client-side logic (inlined) --------- */
    document.addEventListener("DOMContentLoaded", () => {
      const socket = io(); // connects to same origin
      let markers = {}; // map request_id -> leaflet marker

      // Map init (default center India)
      const map = L.map("map").setView([20.5937, 78.9629], 5);
      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        attribution: "&copy; OpenStreetMap contributors"
      }).addTo(map);

      // UI elements
      const roleSelect = document.getElementById("role");
      const victimForm = document.getElementB
        
